(function(e){e.fn.drip=function(t){var n=e.extend({room:"12345",authToken:"abcdef12345",reverse:"true",target:e(this),delay:6e4,maxResults:25},t);var r=n.room,i=n.authToken,s=n.reverse,o=n.target,u=n.delay,a=n.maxResults,f=0;$url="https://api.hipchat.com/v2/room/"+r+"/history?auth_token="+i+"&reverse="+s+"&max-results="+a;e.getJSON($url,function(e){if(!o.find(".hipchat-list").length){o.append('<ul class="hipchat-list"></ul>')}else{f=1}for(var t in e.items){var n=e.items[t].date,r=new Date(n),i=r.toLocaleString(),s=n.replace(/[^0-9.]/g,""),u=o.find(".hipchat-list .date:first").text().replace(/[^0-9.]/g,""),a=e.items[t].from;if(typeof a.name!=="undefined"){a=a.name}else{a=a}if(s>u){o.find(".hipchat-list").prepend('<li class="hipchat-message color-'+e.items[t].color+' "><span class="user-name">'+a+'</span><span class="message">  '+e.items[t].message+'  </span><span class="message-date">'+i+'</span><span class="date" style="display: none;">'+n+"</span></li>");if(f==1){o.find(".hipchat-list li").last().remove()}}}});if(u!=0){setInterval(function(){o.drip({room:r,authToken:i,reverse:s,delay:u})},u)}}})(jQuery)
